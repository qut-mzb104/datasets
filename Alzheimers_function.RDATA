# Alzheimers Abeta40 https://onlinelibrary.wiley.com/doi/pdfdirect/10.1002/gps.4053
# Taken from MAB104 thanks to @Leah South
set.seed(12)

NC <- rnorm(122,0,21)
aMCI <- rnorm(54,0,24)
AD <- rnorm(97,0,19)

# NC <- rnorm(122,0,24.43) # sd should be 22.57
# aMCI <- rnorm(54,0,26.52) # sd should be 26.03
# AD <- rnorm(97,0,19.96) # sd should be 20.30

NC <- 43.14 + (NC - mean(NC))
aMCI <- 51.66 + (aMCI - mean(aMCI))
AD <- 59.10 + (AD - mean(AD))

boxplot(NC,aMCI,AD,names=c("NC","aMCI","AD"),xlab="Condition",
        ylab=expression(paste(Plasma, " levels (pg/mL)")))

mydf <- data.frame(levels = c(NC,aMCI,AD), group = c(rep("NC",122),rep("aMCI",54),rep("AD",97)))

write.csv(mydf,"Alzheimers.csv")

# What is the effect of the treatment on the value ?
model=lm(levels ~ group,data=mydf)
ANOVA=aov(model)
summary(ANOVA)

# Tukey test to study each pair of treatment :
TUKEY <- TukeyHSD(x=ANOVA, conf.level=0.95)
par(mar=c(5,8,4,1)+.1)
plot(TUKEY , las=1 , col="black") #,xlab="Differences in mean levels of bone strength across age"

TukeyHSD(ANOVA)

lattice::histogram(~levels | group,data = mydf, type = "count")
